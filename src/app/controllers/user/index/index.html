<div class="page-content" id="page-user-index">
  <md-card>
    <md-toolbar class="md-table-toolbar md-default">
      <div class="md-toolbar-tools">
        <div class="search-box" layout="row">
          <md-icon>search</md-icon>
          <input type="text" placeholder="输入用户名搜索" ng-model="vm.keyword" ng-keydown="vm.search($event)">
        </div>
        <span flex></span>
        <md-button class="md-icon-button" ng-click="vm.showAddDialog($event)">
          <md-icon class="icon">add</md-icon>
        </md-button>
        <md-button class="md-icon-button" ng-click="vm.query()">
          <md-icon class="icon">refresh</md-icon>
        </md-button>
      </div>
    </md-toolbar>
    <md-progress-linear ng-class="{true: 'visible', false: 'invisible'}[vm.showLoading]" md-mode="indeterminate"></md-progress-linear>
    <md-table-container ng-hide="vm.showLoading && !vm.users">
      <table md-table md-row-select multiple ng-model="vm.selected">
        <thead md-head>
          <tr md-row>
            <th md-column>用户名</th>
            <th md-column>邮箱</th>
            <th md-column>角色</th>
            <th md-column>状态</th>
            <th md-column>创建时间</th>
            <th md-column>最后登录</th>
            <th md-column>操作</th>
          </tr>
        </thead>
        <tbody md-body>
          <tr md-row md-select-id="id" md-select="item" ng-repeat="item in vm.users" class="dn-fade-down">
            <td md-cell>
              {{item.name}}
            </td>
            <td md-cell>
              {{item.email | limitTo: '22'}}
              <md-tooltip>
                {{item.email}}
              </md-tooltip>
            </td>
            <td md-cell>{{item.role.name}}</td>
            <td md-cell ng-class="{true: 'active', false: 'locked'}[item.active]">{{item.active ? '正常' : '锁定'}}</td>
            <td md-cell>{{item.create_at | date: 'yyyy-MM-dd HH:mm:ss'}}</td>
            <td md-cell>{{item.last_login_at || '/' | date: 'yyyy-MM-dd HH:mm:ss'}}</td>
            <td md-cell>
              <md-menu md-position-mode="target-right target">
                <md-button class="md-icon-button" ng-click="$mdOpenMenu($event)">
                  <md-icon md-menu-origin class="icon" ng-click="$mdOpenMenu($event)">more_vert</md-icon>
                </md-button>
                <md-menu-content>
                  <md-menu-item>
                    <md-button ng-click="vm.check($event,item)">
                      <md-icon md-menu-align-target>view_list</md-icon>
                      详情
                    </md-button>
                  </md-menu-item>
                  <md-menu-item>
                    <md-button ng-click="vm.showEditDialog($event,item)">
                      <md-icon md-menu-align-target>mode_edit</md-icon>
                      编辑
                    </md-button>
                  </md-menu-item>
                  <md-menu-item>
                    <md-button ng-click="vm.showDeleteConfirm($event,item)">
                      <md-icon md-menu-align-target>delete</md-icon>
                      删除
                    </md-button>
                  </md-menu-item>
                </md-menu-content>
              </md-menu>
            </td>
          </tr>
        </tbody>
      </table>
      <paging options="vm.pageOptions" class="layout-double-margin" ng-if="vm.pageOptions.count"></paging>
    </md-table-container>
  </md-card>
  <md-progress-circular md-mode="indeterminate" class="page-loading" ng-show="vm.showCircleLoading" md-diameter="100"></md-progress-circular>
</div>